

---

# autosave

# autosave

autosave ( docid )

The ACL function registered for this event will be called if the autosave preference has been selected in Arbortext Editor . The autosave callback must be provided in order for autosave to include repository objects.

- • docid — the document id

The autosave callback returns the following integer values:

- • 0 — the object has not been autosaved

- • anything other than 0 — the object has been autosaved

## Related Topics

- • Repository API callback functions



---

# Browsing_and_Searching_for_Document_Objects

# Browsing and Searching for Document Objects

The Repository API supports browsing through a set of document objects. You may browse through:

- • all objects contained in a folder or virtual document

- • all versions of a specific object

- • the set of objects matching a search criteria

- • the set of objects that contain a given document object



---

# burst_hook_error

# burst_hook_error

dms::burst_hook_error ()

Returns the last burst hook error message stored.

If called outside a hook, returns the value set by the last hook or an empty string if the last hook did not set an error message.

## Related Topics

- • Hook functions

- • set_burst_hook_error



---

# burst_hook_first_oid

# burst_hook_first_oid

dms::burst_hook_first_oid ()

Returns the first OID in the current object. For graphic objects, returns the graphic element that contains the graphic.

Returns oid_null() if called outside a hook.

## Related Topics

- • Hook functions



---

# burst_hook_is_graphic

# burst_hook_is_graphic

dms::burst_hook_is_graphic ()

Specifies whether a function is called from a text or graphic hook.

Returns 1 if hook is being called for a graphic object. Returns 0 if called for a text object.

Returns 0 if called outside a hook.

## Related Topics

- • Hook functions



---

# burst_hook_last_oid

# burst_hook_last_oid

dms::burst_hook_last_oid ()

Returns the last OID in the current object.

Returns oid_null() if called outside a hook.

## Related Topics

- • Hook functions



---

# burst_hook_sess

# burst_hook_sess

dms::burst_hook_sess ()

Returns the session handle, which can be used to call repository API functions.

Results are undefined if called outside a hook.

## Related Topics

- • Hook functions



---

# burst_hook_value

# burst_hook_value

dms::burst_hook_value ()

Returns the candidate object name or location as a string. The string is generated by internal rules, unless changed by the hook.

Returns an empty string if called outside a hook.

## Related Topics

- • Hook functions



---

# burst_multiple

# burst_multiple

burst_multiple ( filepath [, logfile [, flags ]])

This function opens each file specified by filepath individually, bursts them according to the current bursting configuration, and stores the resulting document objects to the connected document repository. The filepath can include wildcard characters.

If your burst configuration is set to automatically burst existing file entity references, your filepath should exclude file entities; they will be burst when the parent document is burst.

The optional logfile parameter specifies where bursting information will be written. If this parameter is not provided, the log information is written to the directory specified by the TMPDIR environment variable in a file called burst NN .log , where NN is a number. If the TMPDIR environment variable is not set, the function attempts to write the logging information to the c:\temp directory on Windows or the /tmp directory on UNIX.

The optional flags parameter specifies overrides to default bursting options. If omitted, the function uses the default bursting options. The flags parameter can use the following bits:

- • 0x0001 — enable full text indexing on the top most object

- • 0x0002 — import file entities

- • 0x0004 — don't import file entities

- • 0x0008 — import graphic files

- • 0x0010 — don't import graphic files

- • 0x0020 — burst on element boundaries

- • 0x0040 — don't burst on element boundaries

- • 0x0080 — use the filename for the topmost object name

- • 0x0100 — don't use the filename for the topmost object name

- • 0x1000 — use location rules for child objects even when useroverride="on" in the burst configuration file

The negative settings override session defaults.

Examples:

```
burst_multiple("c:\\docs\\*.sgm")
burst_multiple("/docs/*.xml","/docs/burst.log",0x0010)
```

## Related Topics

- • dobj_burst function

- • sess_doc_burst function



---

# checkin

# checkin

checkin ( dobj , docid , ud )

This callback corresponds to the Repository API function dobj_checkin and checks in the specified document object. This callback is called after the dobj has been burst. The precheckin callback is called before the dobj has been burst.

- • dobj — an ACL document object handle for the document object to check in

- • docid — the document used for context information

- • ud — user defined information; strings must match the adapter encoding

The checkin callback returns the following integer values:

- • less than 0 — an error has occurred

- • 0 — the normal check-in can be performed

- • greater than 0 — the callback succeeded and has returned the docobj

## Related Topics

- • Repository API callback functions



---

# Connecting_to_Document_Management_Systems

# Connecting to Document Management Systems

The Repository API defines a session that is an abstraction of a connection to a particular document database in a particular document repository by an authorized user. A connected session is a prerequisite to performing document management or browsing operations on objects in the repository. The underlying repository will require the Arbortext Editor user to log in with a user ID and password before authorization to access document objects is granted.



---

# construct

# construct

construct ( poid , docid , reserved , ud )

This callback corresponds to the dobj_construct function and constructs a document object handle ( docobj ) for the document object in the repository.

- • poid — the logical ID for the repository object

- • docid — the document used for context information; required even when you are constructing a document object handle for a folder

- • reserved — for internal use only

- • ud — user defined information; strings must match the adapter encoding

The construct callback returns the following integer values:

- • less than 0 — an error has occurred

- • 0 — the normal construct routine should be performed

- • greater than 0 — the callback succeeded and has returned the docobj

## Related Topics

- • Repository API callback functions



---

# create

# create

create ( name , folder , opts , first , last , version , objtype , ud )

This callback corresponds to the dobj_create and dobj_create_subtree functions and creates a new document object.

- • name — a string representing the name of the document being created.

- • folder — a string representing the path of the parent folder for the new document

- • opts — a complete list of the available bitmask options is available in the dobj_create help topic

- • first — the object ID (oid) of the first object in the document

- • last — the object ID (oid) of the last object in the document

- • ver — the version of the new document object

- • objtype — the repository-specific object type for the new document object as defined in your adapter documentation

- • ud — user defined information; strings must match the adapter encoding

The create callback returns the following integer values:

- • less than 0 — an error has occurred

- • 0 — the normal create routine should be performed

- • greater than 0 — the callback succeeded and has returned the docobj

## Related Topics

- • Repository API callback functions



---

# Customizing_Entity_Names_for_Objects

# Customizing Entity Names for Objects

When you create a new entity object by inserting an object from the browser, a function in the Repository API automatically assigns that entity a unique name (for example, E1340 ). If you wish, you can write your own function for creating entity names, and substitute it in place of the default function.

## To substitute your own entity naming function:

Create an ACL function that creates your desired unique entity names. Observe the following guidelines when creating this function.

- • Your function should accept the following arguments:

- • Your function should return a unique entity name in the form & entname where entname is the name for the entity, and the & is a required prefix character. If a given document contains two different entities that possess the same entity name, the first of the two entities declared will appear in place of both entity references. If you are unsure if your function will always return unique names, you should implement the entitydeclconflicthook and create a function to handle the case when duplicate names are created.

- • The ACL package that contains your entity naming function must be loaded before a user can connect to the repository. Since it is common for documents of different document type definitions (DTDs) to reside in unique document databases, it is typical that the entity naming function be added to the doctype .acl file, where doctype is the file system name for the document type you are using. This would guarantee that the entity naming function would be loaded whenever a file of that document type is loaded/created.

In the file where you create your entity naming function, set the global variable that defines the name of the entity naming function. Add the following line to the file containing your function:

```
$dms::entity_naming_function = "
my_function_name
"
```

In the example above, my_function_name is the name of your desired entity naming function. Make sure that the function name is surrounded by double-quotation marks (").



---

# dobj_burst

# dobj_burst

dobj_burst ( dobj )

Bursts the locked document object represented by the document object handle dobj . The bursting process follows the established defaults and document-type-definition-specific rules for the applicable document type. If the dobj contains sibling (that is, more than one) top-level elements, it will not be burst.

If dobj is invalid, or the burst fails, the function sets $main::ioerr with error information and returns a zero (0). If the burst is successful, the function returns a one (1).

## Related Topics

- • sess_doc_burst function

- • burst_multiple function



---

# dobj_checkin

# dobj_checkin

dobj_checkin ( dobj [, ud ])

Checks in the locked document object possessing the document object handle of dobj . To properly update the revised document in the repository, you must save the object before calling dobj_checkin . All revisions to the document object are then written to the repository.

The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

If dobj is invalid, or the check-in fails, the function sets $main::ioerr and returns a zero ( 0 ). If the check-in is successful, the function returns a document object handle. Note that the returned document object handle may not be the same document object handle that was passed to the function.

The dobj_close function must be called to close the document object after it has been processed. However, the returned document object may differ from the one passed to the function. The document object can be closed by implementing the following sample code.

```
local new_dobj = dobj_checkin(dobj);
if (dobj_valid(new_dobj))
{
# A new dobj was returned. Release the old one and
# start using the new one.
dobj_close(dobj);
dobj = new_dobj;
}
```

## Related Topics

- • dobj_save



---

# dobj_class

# dobj_class

dobj_class ( dobj )

Returns the class for the document object possessing the ACL document object handle of dobj .

If dobj is invalid, or has an unknown class, the function sets $main::ioerr and returns a zero (0). If the operation is successful, the function returns in integer for the class. Possible class values are:

- • 1 = Container (that is, document object with children)

- • 2 = Document object (no children)

- • 3 = Expanded file entity

- • 4 = Unexpanded file entity

- • 5 = File entity open for editing in a separate window

- • 6 = Included object

- • 7 = Fallback markup inserted for a failed XML inclusion



---

# dobj_close

# dobj_close

dobj_close ( dobj )

Closes the document object possessing the ACL document object handle of dobj . If the document object has any children, the function closes them as well.

If dobj is invalid, or the close operation fails, the function sets $main::ioerr and returns a zero ( 0 ). If the operation is successful, the function returns a one ( 1 ).



---

# dobj_collapse_oid

# dobj_collapse_oid

dobj_collapse_oid ( oid , collapse , allinst )

This function either collapses ( collapse =TRUE) or expands ( collapse =FALSE) the parent document object that contains the object oid . If allinst is set to TRUE, the function operates on all instances of the parent document object.

If oid is invalid, or the operation fails, the function places error data in $main::ioerr and returns a zero (0). If successful, the function returns a one ( 1 ).



---

# dobj_construct

# dobj_construct

dobj_construct ( logicalid ., doc [, reserved [, ud ]])

Creates an ACL document object handle for the existing document object indicated by logicalid . The dobj_close function must be called to close the document object after it has been processed.

This function uses the following parameters:

- • logicalid — unique identifier for an object

- • doc — document used for context information; required even when you are constructing a document object handle for a folder

- • reserved — for internal use only

- • ud — can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

The following integers are returned:

- • 0 — operation failed

- • A docobj is returned if the function succeeds.

## Related Topics

- • Repository API callback functions



---

# dobj_create

# dobj_create

dobj_create ( sesshdl , name , loc , opts , doc [, ver [, objtype [, ud ]]])

Creates an empty document object in the repository. The dobj_close function must be called to close the document object after it has been processed.

The sesshdl and name parameters specify the ACL session handle and name the repository should use for the new object (respectively).

The loc parameter contains an adapter-specific pointer to the new object's parent object.

The opts parameter is a bitmask that sets any optional data for the new object. The bits in the opts parameter are:

- • 0x001 = object is locked

- • 0x002 = unused

- • 0x004 = object is a folder

- • 0x008 = object is container (document object with children)

- • 0x010 = object consists of SGML content

- • 0x020 = object consists of XML content

- • 0x040 = reserved bit—do not use

- • 0x080 = object consists of HTML content

- • 0x100 = object consists of text content

The doc parameter contains the ACL document handle for the top-level document object.

The optional ver parameter specifies the version of the new document object.

The objtype parameter sets the adapter-specific object type for the new document object. These object types are defined in the documentation for your adapter.

The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

If the operation fails, the function sets $main::ioerr and returns a zero ( 0 ). If the operation is successful, the function returns the ACL document object handle for the new document object.

## Related Topics

- • Repository API callback functions



---

# dobj_create_subtree

# dobj_create_subtree

dobj_create_subtree ( sesshdl , name , loc , opts , firstoid , lastoid [, ver [, objtype [, ud ]]])

Creates a subtree in the repository. The dobj_close function must be called to close the document object after it has been processed.

The sesshdl and name parameters specify the ACL session handle and name the repository should use for the new object (respectively).

The loc parameter contains an adapter-specific pointer to the new object's parent object.

The opts parameter is a bitmask that sets any optional data for the new object. The bits in the opts parameter are:

- • 0x001 = object is locked

- • 0x002 = unused

- • 0x004 = object is a folder

- • 0x008 = object is container (document object with children)

- • 0x010 = object consists of SGML content

- • 0x020 = object consists of XML content

- • 0x040 = reserved bit—do not use

- • 0x080 = object consists of HTML content

- • 0x100 = object consists of text content

The firstoid and lastoid parameters define the range of the document to be included in the subtree.

The optional ver parameter specifies the version of the new document object.

The objtype parameter sets the adapter-specific object type for the new document object. These object types are defined in the documentation for your adapter.

The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

If the operation fails, the function sets $main::ioerr and returns a zero ( 0 ). If the operation is successful, the function returns the ACL document object handle for the new subtree.



---

# dobj_delete

# dobj_delete

dobj_delete ( dobj [, ud ])

Deletes the document object possessing the ACL document object handle of dobj . The object is marked as deleted in the repository.

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If dobj is invalid, or the operation fails, the function sets $main::ioerr and returns a zero (0). If the operation is successful, the function returns a one (1).



---

# dobj_encl_dobj

# dobj_encl_dobj

dobj_encl_dobj ( dobj )

Returns the document object handle for the object that encloses the document object specified by dobj . If dobj is the top level object, the function returns a 0 . The dobj_close function must be called to close the document object after it has been processed.



---

# dobj_first_dobj

# dobj_first_dobj

dobj_first_dobj ( dobj )

Returns the ACL document object handle for the first valid document object in the chain of document objects containing dobj .

If dobj is invalid, or the operation fails, the function sets $main::ioerr and returns a zero (0).



---

# dobj_first_oid

# dobj_first_oid

dobj_first_oid ( dobj )

Returns the first oid within the document object possessing the ACL document object handle of dobj .

If dobj is invalid, or the operation fails, the function returns null_oid .



---

# dobj_get_attr

# dobj_get_attr

dobj_get_attr ( dobj , attr [, idx ])

Returns the value of metadata attribute attr for the object with the ACL document object handle of dobj . If the desired metadata attribute contains an array, use the optional idx to access the desired entry in the array.

To obtain a Repository API attribute, the attr parameter should have one of two formats:

- • The ACL abstraction of the attribute. ACL attribute names have the format IO_ATTR_ NAME , where NAME is different for a specific attribute. The attributes that can be used with this function are listed in the ACL Attribute Name column of the Attributes names for developers section of your adapter documentation. This function can accept dobj attribute names but will not accept sess attribute names.

- • The repository's name for the attribute. If you supply an attribute name that does not have the IO_ATTR_ NAME format, the function will pass the literal name through to the repository. Using this method, you can access attributes in the repository that are not abstracted in ACL.

If either the dobj or attr values are invalid, or the operation fails, the function places error data in $main::ioerr and returns a NULL.



---

# dobj_get_attrlist

# dobj_get_attrlist

dobj_get_attrlist ( dobj , array )

Use this function to return metadata attribute values for the object with the ACL document object handle of dobj . This function scans the associative array named array , and for each index that matches the name of a native metadata attribute, fills that value in the array with the value for that attribute.

The indices used in array should have one of two formats:

- • The ACL abstraction of the attribute. ACL attribute names have the format IO_ATTR_ NAME , where NAME is different for a specific attribute. The attributes that can be used with this function are listed in the ACL Attribute Name column of the Attributes names for developers section of your adapter documentation. This function can accept dobj attribute names but will not accept sess attribute names.

- • The repository's name for the attribute. If you supply an attribute name that does not have the IO_ATTR_ NAME format, the function will pass the literal name through to the repository. Using this method, you can access attributes in the repository that are not abstracted in ACL.

If the function executes successfully, it returns a one (1). If either the dobj or array values are invalid, or the operation fails, the function returns a zero (0).

Example

```
propvalue["IO_ATTR_IS_CONTAINER"] = "";
propvalue["IO_ATTR_LOCKED"] = "";
propvalue["IO_ATTR_USE_LATEST_REV"] = "";
ret = dobj_get_attrlist (dobj, "propvalue");
```

## Related Topics

- • dobj_get_attr function

- • dobj_set_attr function

- • dobj_set_attrlist function



---

# dobj_is_mod

# dobj_is_mod

dobj_is_mod ( dobj )

Returns a boolean value indicating whether the document object dobj has been modified. If the dobj has been modified, the function returns a one (1). If dobj is invalid, or has not been modified, the function returns a zero (0).



---

# dobj_is_my_lock

# dobj_is_my_lock

dobj_is_my_lock ( dobj )

Returns a boolean value indicating whether the document object dobj is locked by the current user. If the dobj is locked by the current user, the function returns a one (1). If dobj is invalid, or is not locked by the current user, the function returns a zero (0).



---

# dobj_last_oid

# dobj_last_oid

dobj_last_oid ( dobj )

Returns the last oid within the document object possessing the ACL document object handle of dobj .

If dobj is invalid, or the operation fails, the function returns null_oid.



---

# dobj_lock

# dobj_lock

dobj_lock ( dobj , lockflag [, ud ])

Locks, in the repository, the document object with the dobj ACL document object handle.

- • dobj — The object handle of the document object to be locked. If dobj is invalid, or the operation fails, the function sets $main::ioerr and returns a zero (0). If the operation is successful, the function returns a the document handle of the locked object.

- • lockflag — An integer that determines how the lock will take place. The available lockflag values are:

- • The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

The dobj_close function must be called to close the document object after it has been processed. However, the returned document object may differ from the one passed to the function. The document object can be closed by implementing the following sample code.

```
local new_dobj = dobj_lock(dobj, 2);
if (dobj_valid(new_dobj))
{
# A new dobj was returned. Release the old one and
# start using the new one.
dobj_close(dobj);
dobj = new_dobj;
}
```



---

# dobj_logicalid

# dobj_logicalid

dobj_logicalid ( dobj )

This function returns the logical identifier for the document object specified by the document object handle dobj .

If dobj is invalid, the function returns the string <null> . If the function is successful, it returns a logical identifier.



---

# dobj_move

# dobj_move

dobj_move ( sourcedobj , destdobj [, ud ])

This function moves the document object sourcedobj into the folder or cabinet object specified by destdobj .

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If either sourcedobj or destdobj is invalid, or the operation fails, the function sets $main::ioerr and returns a zero (0). If the operation is successful, the function returns the document handle of the object sourcedobj .



---

# dobj_next_dobj

# dobj_next_dobj

dobj_next_dobj ( dobj )

This function closes the document object handle indicated by dobj and returns the document object handle for the next valid document object in the chain of document objects containing dobj .

If dobj is invalid, or the operation fails, the function sets $main::ioerr and returns a zero (0).



---

# dobj_poid

# dobj_poid

dobj_poid ( dobj )

Returns the persistent object ID (POID) for the document object handle of dobj .

If dobj is invalid, or the operation fails, the function sets $main::ioerr and returns <NULL> .



---

# dobj_save

# dobj_save

dobj_save ( dobj , opts [, doc [, ud ]])

Saves a document object.

The dobj parameter specifies the ACL document object handle of the object to save. The doc parameter specifies the ACL document handle that contains the document object. If you do not specify a doc , an ACL document will be taken from the dobj , if possible.

The opts parameter is a bitmask that sets the option flags for the saving process. The bits in the opts parameter are:

- • 0x001 = save attributes

- • 0x002 = save content

- • 0x004 = save declarations

- • 0x008 = do not save any processing instructions

- • 0x010 = save nothing, but reorder the entity reference list (even if it hasn't changed)

- • 0x020 = save any modified children (including entities that were edited inline)

The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

If the operation fails, the function returns a zero ( 0 ). If the operation is successful, the function returns a one ( 1 ).

## Related Topics

- • Repository API callback functions



---

# dobj_session

# dobj_session

dobj_session ( dobj )

Returns the session handle for the document object with the ACL document object handle of dobj .

If dobj is invalid, or the operation fails, the function sets $main::ioerr and returns -1.



---

# dobj_set_attr

# dobj_set_attr

dobj_set_attr ( dobj , attr , val [, idx ])

For the object with the ACL document object handle dobj , this function assigns the value val to the metadata attribute attr . If the desired metadata attribute contains an array, use the optional idx to set the desired entry in the array.

To set a Repository API attribute, the attr parameter should have one of two formats:

- • The ACL abstraction of the attribute. ACL attribute names have the format IO_ATTR_ NAME , where NAME is different for a specific attribute. The attributes that can be used with this function are listed in the ACL Attribute Name column of the Attributes names for developers section of your adapter documentation. This function can accept dobj attribute names but will not accept sess attribute names.

- • The repository's name for the attribute. If you supply an attribute name that does not have the IO_ATTR_ NAME format, the function will pass the literal name through to the repository. Using this method, you can access attributes in the repository that are not abstracted in ACL.

If either the dobj or attr values are invalid, or the operation fails, the function places error data in $main::ioerr and returns a zero (0). If successful, the function returns a one (1).

This function does not commit all attribute changes to the repository until the repository object is closed (using the user interface or the dobj_close function). To commit changes to the repository sooner, use the dobj_save function and specify the option to save attributes.



---

# dobj_set_attrlist

# dobj_set_attrlist

dobj_set_attrlist ( dobj , array )

Use this function to set metadata attribute values for the object with the ACL document object handle of dobj . This function scans the associative array named array , and for each index that matches the name of a native metadata attribute, the function sets the value for that attribute to the value in the array .

The indices used in array should have one of two formats:

- • The ACL abstraction of the attribute. ACL attribute names have the format IO_ATTR_ NAME , where NAME is different for a specific attribute. The attributes that can be used with this function are listed in the ACL Attribute Name column of the Attributes names for developers section of your adapter documentation. This function can accept dobj attribute names but will not accept sess attribute names.

- • The repository's name for the attribute. If you supply an attribute name that does not have the IO_ATTR_ NAME format, the function will pass the literal name through to the repository. Using this method, you can access attributes in the repository that are not abstracted in ACL.

If the function executes successfully, it returns a one (1). If either the dobj or array values are invalid, or the operation fails, the function returns a zero (0).

This function does not commit all attribute changes to the repository until the repository object is closed (using the user interface or the dobj_close function). To commit changes to the repository sooner, use the dobj_save function and specify the option to save attributes.

Example

```
attrlist["IO_ATTR_DTD_PUBLIC"] = \
public_id(current_doc());
attrlist["IO_ATTR_NAME"] = name;
dobj_set_attrlist(dobj, "attrlist");
```

## Related Topics

- • dobj_get_attr function

- • dobj_get_attrlist function

- • dobj_set_attr function



---

# dobj_unlock

# dobj_unlock

dobj_unlock ( dobj [, ud ])

Unlocks, in the repository, the object with the dobj ACL document object handle. Note that this function performs the unlock without performing a check-in.

The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

If dobj is invalid, or the operation fails, the function sets $main::ioerr and returns a zero (0). If the operation is successful, the function returns the document handle of the unlocked object.

The dobj_close function must be called to close the document object after it has been processed. However, the returned document object may differ from the one passed to the function. The document object can be closed by implementing the following sample code.

```
local new_dobj = dobj_unlock(dobj);
if (dobj_valid(new_dobj))
{
# A new dobj was returned. Release the old one and
# start using the new one.
dobj_close(dobj);
dobj = new_dobj;
}
```

## Related Topics

- • Repository API callback functions



---

# dobj_valid

# dobj_valid

dobj_valid ( dobj )

Validates the document object with the dobj ACL document object handle.

If dobj is invalid, or the operation fails, the function returns a zero (0). If the operation is successful, the function returns a one (1).



---

# Document_Object_Management

# Document Object Management

The Repository API is used by Arbortext Editor to access common document management services provided by the underlying repository software.

The supported operations include:

- • Access Control—The Repository API does not provide any access control scheme; it simply provides the hooks for a string describing a document's access privileges to be passed back and forth. The actual granting or denial of access to a particular document by a particular user is the responsibility of the repository. ( Arbortext Editor does not support any modifications of repository permissions from Arbortext Editor ; access control specifications must be made in the repository directly.)

- • Revision Control —The Repository API revision control system scheme is general enough to encompass most revision control schemes. It is inspired by RCS, but has the major difference that it creates a persistent working version of an object as soon as a parent revision is locked. This frees you from the necessity of managing a local version of a locked object until it is checked in. Instead, the working version of an object is immediately created, all subsequent save operations will update the working version in place, then the Object check in operation makes the working version the latest version in the revision list.

- • Document I/O and management—Document objects may be loaded and saved from within Arbortext Editor . Document objects may also be copied or deleted with the Repository API. Repository API routines do not attempt to provide a full range of document object manipulation and administration facilities; those tasks should be handled by the utilities in the underlying repository.

- • Accessing Document Object Metadata—The Repository API requires a base set of metadata fields. Additional metadata fields may be defined by customers or Application Developers to the extent that is feasible on a given platform and for a particular Arbortext Editor application. The Repository API and the Arbortext Editor ACL allow a passthrough between a custom user interface and a custom database to store and retrieve any value of any metadata field.



---

# Error_Message_Handling_in_the_Repository_API

# Error Message Handling in the Repository API

Most non-Repository API ACL functions write error messages to the global variable $ERROR . The functions in the Repository API do not behave the same way. If a Repository API function returns an error state (usually -1 ), the developer should include code to obtain the error text from main::ioerr variable. If the main::ioerr variable contains a value of -183 , then the developer should invoke the sess_err_message function to retrieve the text for the session error that the Repository API function generated.

A sample of such code appears below.

```
# The dobj_lock() function is used for this example.
#
$ret = dobj_lock(..)
#
# Test for errors, values less than zero are errors.
#
if ($ret <=0)
{
#
# Retrieve the error code from main::ioerr.
#
local err_code = main::ioerr;
#
# If the error code is -183, retrieve the session error
# text using the sess_err_message function. Otherwise,
# retrieve the error text from the dms::io_err_msg array
# using the error code as the index into the array.
#
if (err_code == -183)
{
err_message = sess_err_message(sesshdl);
}
else
{
err_message = dms::io_err_msg[err_code]
}
}
```

## Related Topics

- • sess_err_message function



---

# getfile

# getfile

getfile ( poid , opts , rendition , ud )

This callback corresponds to the sess_get_file function and retrieves an object (usually a graphic object) from the document repository. This callback can be used to override the rendition of the file that is retrieved.

- • poid — the logical ID for the repository object

- • opts — an integer value representing the desired operation

- • rendition — the desired rendition of a graphic object; value must match one of the notations declared in your data model

- • ud — user defined information; strings must match the adapter encoding

The getfile callback returns the following string:

- • "IO_ERR_NOMORE" — the normal getfile routine should be performed

- • If any other string is returned, the callback succeeded and the returned string represents the name of the local file that was created. The normal getfile function should not be performed.

## Related Topics

- • Repository API callback functions



---

# import_graphic_folder

# import_graphic_folder

import_graphic_folder ( srcFolder [, cmsFolder [, descend ]])

This function imports all of the graphics stored in a specified file system directory into the connected document repository.

The srcFolder parameter is the file system path to the directory containing the graphics to be imported. This parameter is required for batch session, but is optional for interactive sessions. If an interactive call does not provide a value for this parameter, a browse dialog box is invoked.

The optional cmsFolder parameter is the repository path to the location in which the imported graphic objects should be stored. If a no value is provided for this parameter, the following locations are searched and the first valid location is used:

- • The current folder location in the repository Browser .

- • The default location for new graphic objects in the system-wide burst configuration file

- • The current user's repository home directory

The optional descend parameter indicates whether subdirectories in the srcFolder should be recursively processed. The default is 0 , which disables subdirectory processing. Set the value of this parameter to 1 to enable subdirectory processing.

The function returns 1 if all located graphic objects are successfully imported into the repository or 0 if an error occurs. Processing stops when an error occurs, but any graphic objects that were imported prior to the error are saved in the repository.



---

# lock

# lock

lock ( dobj , lockflags , docid , ud )

This callback corresponds to the dobj_lock function and locks the specified document object.

- • dobj — an ACL document object handle for the document object to lock

- • lockflags — a list of options for this parameter are available in the dobj_lock function help topic

- • docid — the document used for context information

- • ud — user defined information; strings must match the adapter encoding

The lock callback returns the following integer values:

- • less than 0 — an error has occurred

- • 0 — the normal lock routine should be performed

- • greater than 0 — the callback succeeded and has returned the docobj

## Related Topics

- • Repository API callback functions



---

# Logical_IDs

# Logical IDs

The Logical ID is a unique identifier of an object that is used with file entity references. The Logical ID is similar to the POID, but can indicate the binding from the object to the object's parent.

Logical IDs vary depending on the repository being used. Refer to the documentation for your specific adapter for a description of its logical ID syntax. Typically, the logical ID contains the following information:

- • The name of the repository containing the object.

- • An identifier generated by the adapter that uniquely identifies the object.

- • If the link was dynamic (that is, always uses the most recent version), the Logical ID will end with an adapter-specific label indicating a dynamic binding. If the link was static (that is, to a specific version), the Logical ID will end with the object's version label as generated by the repository server.



---

# logicalid_to_poid

# logicalid_to_poid

logicalid_to_poid ( logical_id )

Returns the Persistent Object ID (POID) for the document object with the logical ID of logical_id .

If logical_id is invalid, or the operation fails, the function returns the supplied logical_id value .



---

# oid_dobj

# oid_dobj

oid_dobj ( oid [, obj ])

Returns the document object handle for the element specified by oid (if any). If oid is invalid, or the specified oid has no document object handle, the function returns a zero ( 0 ). If the operation is successful, the function returns the document object handle for the oid . The dobj_close function must be called to close the document object after it has been processed.

A document can have two types of objects: file entity references and other objects. oids representing file entity references may have 2 objects associated with them: one object and one file entity reference object.

If obj is 1 , then file entity objects will not be returned. If it is omitted or 0 , then a file entity object will be returned if there is one on the oid . This means that if the oid has both types of object attached, then the file entity object is returned if obj is omitted or 0 .

An XInclude oid can also have multiple objects attached. This method returns the innermost object on the oid if it is an XML inclusion. If you do not want the innermost object, use the dobj_encl_dobj function.

If oid is not a file entity reference, obj is ignored.



---

# oid_encl_dobj

# oid_encl_dobj

oid_encl_dobj ( oid [, obj [, pos ]])

Returns the document object handle that encloses the element specified by oid and pos (if any). If oid is invalid, or the specified oid is not within a document object, the function returns a zero ( 0 ). If the operation is successful, the function returns the document object handle enclosing the specified oid . The dobj_close function must be called to close the document object after it has been processed.

A document can have two types of objects: file entity references and other objects. An oid representing a file entity references may have 2 objects associated with it: one object and one file entity reference object.

If obj is 1 , then file entity objects will not be returned. If it is omitted or 0 , then a file entity object will be returned if there is one on the parent object oid . This means that if the parent oid has both types of object attached, then the file entity object is returned if obj is omitted or 0 .

An XInclude oid can also have multiple objects attached. This method returns the innermost object on the parent object oid if it is an XML inclusion. If you do not want the innermost object, use the dobj_encl_dobj function.

If the parent object oid is not a file entity reference, obj is ignored.

pos can be any of the following values:

- • 0 — (The default.) pos is immediately after the start tag identified by oid .

- • -1 — pos is immediately before the end tag of the element identified by oid .

- • -2 — pos is immediately before the start tag.

- • -3 — If oid is a start tag, pos is immediately after the end tag. Otherwise, pos is at the end of the object.



---

# oid_encl_poid

# oid_encl_poid

oid_encl_poid ( oid [, obj [, pos ]])

Returns the POID that encloses the element specified by oid and pos (if any). If oid is invalid, or the specified oid is not within a POID, the function returns a null string. If the operation is successful, the function returns the POID enclosing the specified oid .

A POID can have two document objects when the POID is a reference to a file entity. The POID will always have a document object handle for the contents of the file entity being referenced. If the reference POID itself is a top-level sibling in another object, it will also have a document object handle for that object.

If obj is 1 , then file entity objects will not be returned. If it is omitted or 0 , then a file entity object will be returned if there is one on the parent object oid . This means that if the parent oid has both types of object attached, then the file entity object is returned if obj is omitted or 0 .

pos can be any of the following values:

- • 0 — (The default.) pos is immediately after the start tag identified by oid .

- • -1 — pos is immediately before the end tag of the element identified by oid .

- • -2 — pos is immediately before the start tag.

- • -3 — If oid is a start tag, pos is immediately after the end tag. Otherwise, pos is at the end of the object.



---

# oid_poid

# oid_poid

oid_poid ( oid )( obj )

Returns the POID for the element specified by oid (if any). If oid is invalid, or the specified oid has no POID, the function returns a null string. If the operation is successful, the function returns the POID for the oid .

A POID can have two document objects when the POID is a reference to a file entity. The POID will always have a document object handle for the contents of the file entity being referenced. If the reference POID itself is a top-level sibling in another object, it will also have a document object handle for that object.

If oid is a file entity reference, omitting obj or setting obj to a value of 0 specifies that oid_poid will return the document object handle of the contents of the file entity. If oid is a file entity reference, setting obj to a value of 1 specifies that oid_poid will return the document object handle of the reference POID.

If oid is not a file entity reference, obj is ignored.



---

# oid_set_dobj

# oid_set_dobj

oid_set_dobj ( oid , dobj )

Associates the element oid with the document object dobj .

If oid or dobj are invalid, the function writes error data to $main::ioerr and returns a zero (0). If the operation is successful, the function returns a one (1).



---

# path_session

# path_session

path_session ( path )

If the specified path is the correct logical id format for a connected repository, path_session returns the Arbortext Editor session handle for communicating with that repository. If the format of the specified path is not correct for any connected repositories, path_session returns zero ( 0 ).

## Related Topics

- • sess_connect function

- • sess_info function



---

# Persistent_Object_Identifiers_(POIDs)

# Persistent Object Identifiers (POIDs)

A document object is identified by a Persistent Object ID, or POID. A POID is a string that uniquely identifies a specific revision of a specific object in a specific document database (or docbase). The precise format is left to the developers of a particular repository adapter, but adapter writers should use a standard format such as an Internet URL. Furthermore, all POIDs for a specific repository should have a unique signature at the beginning called the poid prefix. For URL-style POIDs, this would be encoded in the protocol field.

For example, consider a hypothetical repository called SGMBASE. A URL-style POID (assuming that “SGMBASE” does not conflict with any Internet standard protocol names and it has been registered as unique with Arbortext ) would have the signature x-sgmbase:// and an example POID would be x-sgmbase://docbasename–65AF54AAF–01002 , where docbasename is the name of the specific docbase containing the object.



---

# poid_exists

# poid_exists

poid_exists ( poid )

Verifies the existence of the document object with a given poid within any of the currently active repositories.

If poid is invalid, or the operation fails, the function writes error data to $main::ioerr and returns a zero (0). If the operation is successful, the function returns a one (1).



---

# poid_first_oids

# poid_first_oids

poid_first_oids ( poid , arr )

Returns a non-associative array arr containing a list of the OIDs for the first siblings to the specified poid .

If the operation fails, the function writes error data to $main::ioerr and returns a zero (0).



---

# poid_list_children

# poid_list_children

poid_list_children ( logicalid , child_array [, ud ])

Builds an array child_array containing data for the children (if any) of the document object logicalid .

The ACL array child_array will contain the following data.

- • Type of POID

- • Name of document object

- • Revision number of the POID

- • Is the object locked (Locked = True, Unlocked = False)?

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If logicalid is invalid, or the operation fails, the function writes error data to $main::ioerr and returns -1 . If the operation is successful, the function returns the number of entries added to the output array.

## Related Topics

- • Repository API Callback functions



---

# poid_list_parents

# poid_list_parents

poid_list_parents ( logicalid , parent_array [, ud ])

Builds an array parent_array containing the POIDs that contain the document object logicalid .

The ACL array parent_array will contain the following data.

- • Type of POID (usually C for container).

- • Name of document object.

- • POID of the document object.

- • Revision number of the POID

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If logicalid is invalid, or the operation fails, the function writes error data to $main::ioerr and returns -1 . If the operation is successful, the function returns the number of entries added to the output array.

## Related Topics

- • Repository API Callback functions



---

# poid_list_revs

# poid_list_revs

poid_list_revs ( logicalid , rev_array [, ud ])

Builds an array rev_array containing revision data for the document object logicalid .

The ACL array rev_array will contain the following data.

- • Type of POID

- • Name of document object

- • Revision number of the POID

- • Is the object locked (Locked = True, Unlocked = False)?

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If logicalid is invalid, or the operation fails, the function writes error data to $main::ioerr and returns -1 . If the operation is successful, the function returns the number of entries added to the output array.

## Related Topics

- • Repository API Callback functions



---

# poid_list_search_attr

# poid_list_search_attr

poid_list_search_attr ( sesshdl , query , result_array [, ud ])

Builds an array result_array containing data for all document objects (if any) within the repository specified by sesshdl , using the query query , and matching the object info within result_array .

The ACL array result_array can contain the following data.

- • Type of POID

- • Name of document object

- • Revision number of the POID

- • Is the object locked (Locked = True, Unlocked = False)?

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If the operation fails, the function writes error data to $main::ioerr and returns -1 . If the operation is successful, the function returns the number of entries added to the output array.

## Related Topics

- • Repository API Callback functions



---

# poid_list_search_text

# poid_list_search_text

poid_list_search_text ( sesshdl , query , result_array [, ud ])

Builds an array result_array containing data for all document objects (if any) within the repository specified by sesshdl , using the query query , and matching the object info within result_array .

The ACL array result_array can contain the following data.

- • Type of POID

- • Name of document object

- • Revision number of the POID

- • Is the object locked (Locked = True, Unlocked = False)?

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If the operation fails, the function writes error data to $main::ioerr and returns -1 . If the operation is successful, the function returns the number of entries added to the output array.

## Related Topics

- • Repository API Callback functions



---

# poid_to_logicalid

# poid_to_logicalid

poid_to_logicalid ( poid [, verlabel ])

This function accepts the persistent object identifier (POID) poid and the optional version label verlabel and returns a logical identifier. The logical identifier is used to represent a particular binding or version of a document object. The function returns the logical identifier on success and an error code (that is, less than zero) on error.



---

# postburst

# postburst

postburst ( succeeded , doc )

This callback is invoked immediately after a document is burst. It is always called, regardless of whether the burst succeeded. Bursting may occur when a document is imported, saved, or checked in, depending on the repository adapter's bursting policy.

Errors reported by post-burst hooks are not fatal. If errors are reported, the burst is still considered successful and sess_doc_burst() will not return an error. succeeded has the following values:

- • 1 — The burst succeeded.

- • 0 — A bursting error occurred.

postburst( succeeded ) returns the following integer values:

- • 0 — The burst can proceed.

- • < 0 — An error has occurred.

The doc parameter specifies the document identifier for the document to burst.

## Related Topics

- • Repository API callback functions

- • preburst



---

# preburst

# preburst

preburst ( doc )

This callback is invoked immediately before a document is burst. Bursting may occur when a document is imported, saved, or checked in, depending on the repository adapter's bursting policy. The preburst() callback may not perform the bursting itself. The doc parameter specifies the document identifier for the document to burst.

preburst() returns the following integer values:

- • 0 — The burst can proceed.

- • < 0 — An error has occurred.

## Related Topics

- • Repository API callback functions

- • postburst



---

# precheckin

# precheckin

precheckin ( dobj , docid , ud )

This callback corresponds to the dobj_checkin function and is called just before the dobj is burst. The checkin callback is called after the dobj is burst.

- • dobj — an ACL document object handle for the document object to check in

- • docid — the document used for context information

- • ud — user defined information; strings must match the adapter encoding

The precheckin callback returns the following integer values:

- • less than 0 — an error has occurred

- • 0 — the check-in can proceed

- • greater than 0 — the callback succeeded and has returned the docobj

## Related Topics

- • Repository API callback functions



---

# putfile

# putfile

putfile ( filename , objectname , folder , rendition , ud )

This callback corresponds to the sess_put_file function and adds a file (usually a graphic file) to the document repository.

- • filename — the name of the file to add to the repository

- • objectname — the name of the new object to add to the repository

- • folder — the location for the new object in the repository

- • rendition — the desired rendition of a graphic object; value must match one of the notations declared in your data model

- • ud — user defined information; strings must match the adapter encoding

The putfile callback returns the following string:

- • "IO_ERR_NOMORE" — the normal putfile routine should be performed

- • If any other string is returned, the callback succeeded and the returned string represents the logical ID of the object that was created. The normal putfile function should not be performed.

## Related Topics

- • Repository API callback functions



---

# Registering_Callbacks

# Registering Callbacks

Use sess_add_callback to register the ACL callback for a particular Repository API event. The following examples demonstrate how to register callback events to functions from the sample package rep_api .

```
# Override the autosave, checkin, lock and getfile behavior.
sess_add_callback(sess, "autosave", "rep_api::autosave");
sess_add_callback(sess, "checkin", "rep_api::checkin");
sess_add_callback(sess, "lock", "rep_api::checkout");
sess_add_callback(sess, "getfile", "rep_api::getfile");
```

Refer to Repository API callback functions for a list of callback types and their related repository API functions.



---

# Repository_API_Callback_Functions

# Repository API Callback Functions

Adapter integrators may find it necessary to expand the functionality of the default Repository Adapter behavior by using ACL functions that Arbortext Editor executes before calling the equivalent function within the Repository API. The following table lists the callback functions and their corresponding Repository API function(s):

The ACL startup file for the adapter registers callbacks for events such as autosave , checkin , lock , and getfile . This allows the adapter to, for example, save an object if the autosave preference has been set, extend checkin to capture user comments before the actual check-in occurs, instruct lock to inquire about version selection and allow getfile to accommodate different graphic rendition formats.

The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. The Adapters use 16–bit Unicode strings.



---

# Repository_API_Functions_—_Overview

# Repository API Functions — Overview

The Repository API functions facilitate communications between Arbortext Editor and a variety of document repositories. You can write corresponding Repository API callbacks for some of these functions.



---

# save

# save

save ( dobj , first , last , opts , ud )

This callback corresponds to the dobj_save function and saves a document.

- • dobj — an ACL document object handle for the document object to save

- • first — the object ID (oid) of the first object in the document

- • last — the object ID (oid) of the last object in the document

- • opts — a complete list of the available bitmask options is available in the dobj_save help topic

- • ud — user defined information; strings must match the adapter encoding

The save callback returns the following integer values:

- • less than 0 — an error has occurred

- • 0 — the normal save should proceed

- • greater than 0 — the callback succeeded and has returned the docobj

## Related Topics

- • Repository API callback functions



---

# sess_add_callback

# sess_add_callback

sess_add_callback ( sesshdl , fcode , fname )

For the currently active session sesshdl , this function sets a callback for the session function fcode to call the ACL function fname .

The legal session fcode s are:

- • autosave

- • checkin

- • construct

- • create

- • getfile

- • lock

- • postburst

- • preburst

- • precheckin

- • putfile

- • save

- • unlock

If the operation fails, the function writes error data to $main::ioerr and returns a zero (0). If successful, the function returns a one (1).

## Related Topics

- • Repository API Callback functions



---

# sess_bursting

# sess_bursting

This function assesses whether the session identified by sess , the currently active session handle, is currently bursting a document into the repository.

The function returns 1 if true, 0 if not true, or a negative value of the session handle is invalid.

The function is intended to be used in a callback or hook function which might be called when bursting is active since it will return 0 otherwise.

## Related Topics

- • sess_doc_burst



---

# sess_clear_burst_config

# sess_clear_burst_config

sess_clear_burst_config ( session )

Clears out all burst configuration settings that have been loaded for the given repository session and reloads the system-wide burst configuration settings. Document-type-specific burst configurations are then loaded as needed, for example, when a document of that document type is burst.

You can use this function while developing your burst configuration files. The function enables you to test new burst configuration settings without having to exit Arbortext Editor . The function does not change the location that Arbortext Editor uses to load burst configuration files.



---

# sess_connect

# sess_connect

sess_connect ( dlid , id , pw , repid [, ud ])

Connects the user id using a password of pw to the repository repid with the dynamic library ID of dlid .

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If the operation fails, the function places error data in $main::ioerr and returns -1. If successful, the function returns a new session handle for the connection.

## Related Topics

- • Repository API Callback functions

- • path_session function



---

# sess_connected

# sess_connected

sess_connected ( adapterName , dmsid )

Checks whether the session is connected to the specified adapter and dmsid. sess_connected returns 1 if a session exists. Otherwise, it returns 0 .

The following table summarizes the parameter values.



---

# sess_disconnect

# sess_disconnect

sess_disconnect ( sesshdl )

Disconnects the session sesshdl .

If sesshdl is invalid, or the operation fails, the function places error data in $main::ioerr and returns a zero (0). If successful, the function returns a one (1).



---

# sess_doc_burst

# sess_doc_burst

sess_doc_burst ( sesshdl [, doc [, flags [, name [, folder [, fid ]]]]])

Bursts the specified document into an established repository session. The document must be a file system object. The sesshdl parameter is the currently active session handle. The doc specifies the document to burst. If zero (0), the current document is used. The flags parameter specifies any desired overrides to default bursting options and is published by ORing the following bits:

- • 0x0001 — Enable full text indexing on the top most object.

- • 0x0002 — Import file entities.

- • 0x0004 — Do not import file entities.

- • 0x0008 — Import graphic files.

- • 0x0010 — Do not import graphic files.

- • 0x0020 — Burst on element boundaries.

- • 0x0040 — Ignore element boundaries.

- • 0x0080 — Use the file name for the topmost object name.

- • 0x0100 — Do not use the file name for the topmost object name.

- • 0x0400 — Lock the topmost object for editing.

- • 0x0800 — Do not lock the topmost object.

- • 0x1000 — Use location rules for child objects even when useroverride="on" in the burst configuration file.

The negative flag settings override session defaults.

The name parameter gives a user-specified name to use for the topmost object. If the value is a null string, then the bursting rules are consulted.

The folder parameter gives a user-specified destination folder for all objects created. If your system-wide bursting configuration specification has the useroverride set to on , then the folder parameter gives a user-specified destination folder for all objects created. If a null string, then the bursting rules determine in which folders the new objects are created. If your system-wide bursting configuration specification has the useroverride set to off , then the folder parameter is not used and the bursting rules determine in which folders the new objects are created.

The fileid is an ACL file handle as returned by open() to use for logging information and error messages. If fileid is greater than or equal to zero ( 0 ), then no logging is performed.

If the dobj contains sibling (that is, more than one) top-level elements, it will not be burst. If dobj is invalid, or the burst fails, the function sets $main::ioerr with error information and returns a zero ( 0 ). If the burst is successful, the function returns a one ( 1 ).

## Related Topics

- • dobj_burst function

- • burst_multiple function



---

# sess_element_is_boundary

# sess_element_is_boundary

sess_element_is_boundary ( sesshdl , elementname [, doc ])

For the repository session sesshdl , this function inspects the specified elementname for the specified doc and returns a value indicating the following:

- • Whether or not the elementname is a bursting boundary.

- • If the elementname is a bursting boundary, should it be burst as a file entity reference or a virtual document child.

The sesshdl parameter is a session handle. The elementname is the name of an element within the document's document type definition (DTD). The optional parameter doc is a document identifier for the desired document. If omitted, the return value for current_doc is used.

The possible return values are:

- • 0 — oid is not a bursting boundary.

- • 1 — oid is a bursting boundary and should be a file entity reference.

- • 2 — oid is a bursting boundary and should be a virtual document child.

- • 3 — oid is a bursting boundary and should be an XML inclusion reference.

## Related Topics

- • sess_is_boundary function



---

# sess_end

# sess_end

sess_end ( hSess )

Disconnects a user from a repository. This function is the preferred method of disconnecting users from repositories using ACL. The hSess parameter is the session handle returned by sess_start . sess_end returns 1 if the session is successfully ended. If an error occurs during disconnection, such as encountering an invalid handle, sess_end returns 0 .

## Related Topics

- • sess_start function



---

# sess_err_message

# sess_err_message

sess_err_message ( sesshdl )

Returns the session error message. Use this function to obtain the session-specific error message when another Repository API function returns an error code of -183 . The sesshdl parameter is a session handle.

## Related Topics

- • Error message handling in the Repository API



---

# sess_extension

# sess_extension

sess_extension ( sesshdl , opcode , argArray )



This function invokes a repository adapter-specific extension function. Some adapters provide functionality beyond the standard ACL repository API. Each function is identified by an integer opcode that is defined by the adapter. Extension functions take an array of strings as arguments and return a string. sess_extension returns the result of the opcode extension method, which is typically a string or number.

- • sesshdl is a session handle.

- • opcode is an integer that identifies which extension method to invoke.

- • argArray is an array of argument values. The number of parameters and their meaning depends on the specific extension function.

If opcode is invalid or the extension method fails, sess_extension writes error data to $main::ioerr . The value returned on failure depends on the specific extension method.



---

# sess_get_attr

# sess_get_attr

sess_get_attr ( sesshdl , attr )

Returns the value for the session attribute attr within the currently active session sesshdl .

To obtain an attribute value, attr should have a format of IO_ATTR_ NAME , where NAME is different for a specific attribute. The session attributes that can be used with this function are listed in the ACL Attribute Name column of the Attributes names for developers section of your adapter documentation. This function can accept sess attribute names and will not accept dobj attribute names.

If the specified attr is a repeating attribute, you can supply a string with the attribute name and array index (for example, attrname [ idx ] ) to access the desired entry in the array.

If the operation fails, the function writes error data to $main::ioerr and returns a zero (0).

## Related Topics

- • sess_set_attr function



---

# sess_get_create_info

# sess_get_create_info

sess_get_create_info ( sesshdl , return_array )

For the session sesshdl , this function builds an array return_array containing the system-wide object creation information that is not specific to a document type definition (DTD). The return_array is an associative array and can be used to build a user interface that shows default values for a new object and allows the user to override those defaults.

The array is the same for all adapters. Some adapters do not use all the indices in the array; these indices will be left empty.

The ACL array return_array will contain the following data:

If sesshdl is invalid, or the operation fails, the function writes error data to $main::ioerr and returns a zero (0). If the operation is successful, the function returns a one (1).



---

# sess_get_file

# sess_get_file

sess_get_file ( poid , opts [, rendition [, ud ]])

Returns the name of a local file that contains the specified poid using the read option opts . An opts entry of one (1) reads the file as “read-only”; an opts entry of two (2) reads the file as “read\write”.

Use the optional rendition parameter to specify the desired rendition when retrieving the contents of a graphic object. The rendition must match one of the Notations declared in your DTD.

The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

If the operation fails, the function writes error data to $main::ioerr and returns a zero (0).

## Related Topics

- • Repository API Callback functions

- • sess_put_file function



---

# sess_get_file_poid

# sess_get_file_poid

sess_get_file_poid ( sesshdl , filename )

This function is used to query the entity lookup table . During document bursting, Arbortext Editor refrains from adding the same file-based entity to the document repository more than once, preferring to use the exiting object in the repository. The entity lookup table maintains a list of the file entities already added and their respective persistent object identifiers (POIDs) in the repository.

The sesshdl parameter is a session handle. The filename parameter is the path to the file entity which has been added to the repository.

This function returns the POID of the document object matching the provided filename and a zero ( 0 ) if the filename was not in the table.

## Related Topics

- • sess_set_file_poid function



---

# sess_get_graphic_create_info

# sess_get_graphic_create_info

sess_get_graphic_create_info ( sesshdl , asisstart , return_array )

For the session sesshdl , this function builds an array return_array containing the default creation information for a new graphic object. The return_array is an associative array and can be used to build a user interface that shows default values for a new graphic object and allows the user to override those defaults.

The asisstart parameter is the starting node for the new graphics object.

The ACL array return_array will contain the following data:

If sesshdl is invalid, or the operation fails, the function writes error data to $main::ioerr and returns a zero (0). If the operation is successful, the function returns a one (1).



---

# sess_get_obj_create_info

# sess_get_obj_create_info

sess_get_obj_create_info ( sesshdl , asisstart , asisend , top , return_array )

For the session sesshdl , this function builds an array return_array containing the default creation information for a new object. The return_array is an associative array and can be used to build a user interface that shows default values for a new object and allows the user to override those defaults.

The asisstart and asisend parameters define the starting and ending nodes for the new object.

The top parameter indicates whether the “topmost is filename” naming rule is being used.

The array is the same for all adapters. Some adapters do not use all the indices in the array; these indices will be left empty.

The ACL array return_array will contain the following data:

If sesshdl is invalid, or the operation fails, the function writes error data to $main::ioerr and returns a zero (0). If the operation is successful, the function returns a one (1).



---

# sess_info

# sess_info

sess_info ( sesshdl )

Returns information for the session sesshdl , including its POID prefix. The resulting string of returned data will consist of several fields, separated by “;” delimiters.

If sesshdl is invalid, or the operation fails, the function places error data in $main::ioerr and returns a zero (0).

## Related Topics

- • path_session function



---

# sess_initialize

# sess_initialize

sess_initialize ( library [, ud ])

Sets up a session that could connect to a repository. The function uses adapter data from the library located in the file name (including path) specified by library .

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If library is invalid, or the operation fails, the function places error data in $main::ioerr and returns -1. If successful, the function returns a dllid (dynamic loading library identification) for the library.

## Related Topics

- • Repository API Callback functions



---

# sess_is_boundary

# sess_is_boundary

$ret= sess_is_boundary ( sesshdl , oid )

For the repository session sesshdl , this function inspects the specified oid and returns a value indicating the following:

- • Whether or not the oid is a bursting boundary.

- • If the oid is a bursting boundary, should it be burst as a file entity reference or a virtual document child.

The sesshdl parameter is a session handle. The oid parameter is an object identifier for the specific object location in the document.

The possible return values are:

- • 0 — oid is not a bursting boundary.

- • 1 — oid is a bursting boundary and should be a file entity reference.

- • 2 — oid is a bursting boundary and should be a virtual document child.

- • 3 — oid is a bursting boundary and should be an XML inclusion reference.

## Related Topics

- • sess_element_is_boundary function



---

# sess_put_file

# sess_put_file

$poid = sess_put_file ( sesshdl , filename , objectname , folder , rendition [, ud ])

This function creates a new object in the document repository from the contents of filename . The function is intended to be used to add graphic files to the repository. To move an SGML, XML or HTML document into the repository, use the document bursting function (for example, dobj_burst ).

The sesshdl parameter is a session handle. The objectname parameter specifies the name for the new object in the repository. Use the folder parameter to specify a destination location (in the repository) for the new object. Use the rendition parameter to specify the type of data that is being saved. The rendition must match one of the Notations declared in your DTD.

The ud parameter can be used to pass user defined information to a callback; strings must match the adapter encoding. Refer to Repository API Callback functions for more information on using callbacks with the Repository API functions.

The function returns a logical ID on sucess.

If the operation fails, the function writes error data to $main::ioerr and returns a zero (0).

## Related Topics

- • Repository API Callback functions

- • sess_get_file function



---

# sess_set_attr

# sess_set_attr

sess_set_attr ( sesshdl , attr , value )

Within the currently active session sesshdl , this function sets the attribute attr to the value value .

If the specified attr is a repeating attribute, you can supply a string with the attribute name and array index (for example, attrname [ idx ] ) to set the desired entry in the array.

To set an attribute value, attr should have a format of IO_ATTR_ NAME , where NAME is different for a specific attribute. The session attributes that can be used with this function are listed in the ACL Attribute Name column of the Attributes names for developers section of your adapter documentation. This function can accept sess attribute types and will not accept dobj attribute types.

If the operation fails, the function writes error data to $main::ioerr and returns a zero (0). If successful, the function returns a one (1).

## Related Topics

- • sess_get_attr function



---

# sess_set_file_poid

# sess_set_file_poid

sess_set_file_poid ( sesshdl , filename , poid )

This function is used to add an entry to the entity lookup table . During document bursting, Arbortext Editor refrains from adding the same file-based entity to the document repository more than once, preferring to use the exiting object in the repository. The entity lookup table maintains a list of the file entities already added and their respective persistent object identifiers (POIDs) in the repository.

The sesshdl parameter is a session handle. The filename parameter is the path to the file entity which has been added to the repository. The poid parameter is the POID of the file entity in the repository.

This function returns one ( 1 ) on success and zero ( 0 ) on failure. If the file is already in the table, it returns a zero ( 0 ) and displays the following message: Table entry found for filename ( poid ), no new table entry added.

## Related Topics

- • sess_get_file_poid function



---

# sess_share

# sess_share

sess_share ( sesshdl , OID_start , OID_end , folder [, ud ])

Shares a range of elements (from OID_start to OID_end ) as an object within the indicated session sesshdl . If necessary, the adapter will burst the selected range of elements according to the current burst configuration. The folder parameter is a string representing the path and name of the parent directory for the document to be created. sess_share uses the following bursting rules to determine whether an XML inclusion or entity reference should be used when creating a new object:

The ud parameter passes user defined data through to the adapter-specific implementation of this function.

If sesshdl , OID_start , or OID_end are invalid, or the operation fails, the function places error data in $main::ioerr and returns a zero (0). If successful, the function returns the ACL document object handle for the new document object.

The dobj_close function must be called to close the document object after it has been processed.

## Related Topics

- • Repository API Callback functions



---

# sess_start

# sess_start

sess_start ( adapt , userid , pw , dmsid , adptdata , mode , win )

Connects a user to a repository. This function is a wrapper for other functions such as sess_connect and sess_initialize and is the preferred method of connecting users to repositories using ACL.

The following table summarizes the parameter values.

If the operation fails, the function places error data in $main::ioerr and returns -1 . If successful, the function returns a new session handle for the connection.

When disconnecting a user from a repository, use the sess_end function to perform all the disconnection steps in their proper order.



---

# sess_terminate

# sess_terminate

sess_terminate ( dllid )

Unloads the repository adapter specified by dllid .

If dllid is invalid, or the operation fails, the function places error data in $main::ioerr and returns a zero (0). If successful, the function returns a one (1).



---

# sess_user_override

# sess_user_override

sess_user_override ( sesshdl )

This function returns a one ( 1 ) if the session specified by sesshdl has the user override set on for bursting-related options such as object names. The function returns a zero if there is an error or if the specified session does not have user override set. The sesshdl parameter is a session handle.



---

# set_burst_hook_error

# set_burst_hook_error

dms::set_burst_hook_error ( msg )

Called by hooks to set the error message to msg and stop the burst. The hook will continue to execute until it returns.

Has no effect if called outside a hook.

## Related Topics

- • Hook functions

- • burst_hook_error



---

# set_burst_hook_value

# set_burst_hook_value

dms::set_burst_hook_value ( value )

Called by a hook to set the new candidate object name or location to value .

Has no effect if called outside a hook.

## Related Topics

- • Hook functions



---

# unlock

# unlock

unlock ( dobj , docid , ud )

This callback corresponds to the dobj_unlock function and unlocks the desired document object.

- • dobj — an ACL document object handle for the document object to lock

- • docid — the document used for context information

- • ud — user defined information; strings must match the adapter encoding

The unlock callback returns the following integer values:

- • less than 0 — an error has occurred

- • 0 — the normal unlock should proceed

- • greater than 0 — the callback succeeded and has returned the docobj

## Related Topics

- • Repository API callback functions